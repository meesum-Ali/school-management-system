import{j as e,L as x,P as g,U as m,r as c,A as N,G as w,X as S,Y as v}from"./index-C8VS4fXx.js";import{C as u,B as i}from"./Card-OmK6nwwd.js";import{N as f}from"./Notification-B1yMlq7q.js";const A=({schools:n,onDelete:l})=>n.length===0?e.jsxs(u,{children:[e.jsx("p",{className:"text-center text-gray-500",children:"No schools found."}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx(i,{component:x,to:"/admin/schools/create",children:"Create New School"})})]}):e.jsxs(u,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Schools"}),e.jsx(i,{component:x,to:"/admin/schools/create",children:"Create New School"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Domain"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Admin User ID"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:s.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.domain||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.adminUserId||"N/A"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[e.jsx(i,{component:x,to:`/admin/schools/${s.id}`,variant:"outline",size:"sm",className:"mr-2",children:"Edit"}),e.jsx(i,{variant:"destructive",size:"sm",onClick:()=>l(s.id),children:"Delete"})]})]},s.id))})]})})]}),E=()=>{const[n,l]=c.useState([]),[s,d]=c.useState(!0),[h,a]=c.useState(null),{user:o}=c.useContext(N),p=async()=>{if(!o||!o.roles.includes(m.SUPER_ADMIN)){a("You don't have permission to view schools."),d(!1);return}try{d(!0),a(null);const t=await S();l(t)}catch(t){const r=t instanceof Error?t.message:"Failed to fetch schools.";a(r),console.error(t)}finally{d(!1)}};c.useEffect(()=>{p()},[o]);const j=async t=>{if(window.confirm("Are you sure you want to delete this school? This action is critical and may affect many users and data."))try{a(null),await v(t),p()}catch(r){const y=r instanceof Error?r.message:"Failed to delete school.";a(y),console.error(r)}};return e.jsx(w,{children:e.jsxs("div",{className:"container mx-auto p-4",children:[h&&e.jsx(f,{message:h,type:"error",onClose:()=>a(null)}),s?e.jsx("p",{className:"text-center",children:"Loading schools..."}):!o||!o.roles.includes(m.SUPER_ADMIN)?e.jsx(f,{message:"Access Denied: You do not have permission to manage schools.",type:"error"}):e.jsx(A,{schools:n,onDelete:j})]})})},b=()=>e.jsx(g,{requiredRoles:[m.SUPER_ADMIN],children:e.jsx(E,{})});export{b as default};
