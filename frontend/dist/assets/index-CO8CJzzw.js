import{j as e,L as h,P as f,U as x,r as n,A as N,G as u,I as w,J as C}from"./index-C8VS4fXx.js";import{C as v,B as d}from"./Card-OmK6nwwd.js";import{N as j}from"./Notification-B1yMlq7q.js";const b=({classes:i,onDelete:c})=>e.jsxs(v,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Class Management"}),e.jsx(d,{component:h,to:"/admin/classes/create",children:"Create Class"})]}),i.length===0?e.jsx("p",{children:"No classes found."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Level"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Homeroom Teacher ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subjects"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.map(s=>e.jsxs("tr",{children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[s.id.substring(0,8),"..."]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:s.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.level}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.homeroomTeacherId||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.subjects?.length||0}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-right",children:[e.jsx(d,{component:h,to:`/admin/classes/${s.id}`,variant:"outline",size:"sm",className:"mr-2",children:"Edit / View Subjects"}),e.jsx(d,{variant:"destructive",size:"sm",onClick:()=>c(s.id),children:"Delete"})]})]},s.id))})]})})]}),L=()=>{const[i,c]=n.useState([]),[s,l]=n.useState(!0),[m,a]=n.useState(null),{user:o}=n.useContext(N),p=async()=>{try{l(!0),a(null);const t=await w();c(t)}catch(t){const r=t instanceof Error?t.message:"Failed to fetch classes.";a(r),console.error(t)}finally{l(!1)}};n.useEffect(()=>{o?.roles.includes(x.SCHOOL_ADMIN)?p():l(!1)},[o]);const g=async t=>{if(window.confirm("Are you sure you want to delete this class? This action cannot be undone."))try{a(null),await C(t),p()}catch(r){const y=r instanceof Error?r.message:"Failed to delete class.";a(y),console.error(r)}};return o?.roles.includes(x.SCHOOL_ADMIN)?e.jsx(u,{children:e.jsxs("div",{className:"container mx-auto p-4",children:[m&&e.jsx(j,{message:m,type:"error",onClose:()=>a(null)}),s?e.jsx("p",{className:"text-center",children:"Loading classes..."}):e.jsx(b,{classes:i,onDelete:g})]})}):e.jsx(u,{children:e.jsx("div",{className:"container mx-auto p-4",children:e.jsx(j,{message:"You do not have permission to manage classes.",type:"error"})})})},I=()=>e.jsx(f,{requiredRoles:[x.SCHOOL_ADMIN],children:e.jsx(L,{})});export{I as default};
