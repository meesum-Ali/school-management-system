import{j as e,P as g,U as u,u as N,M as y,r,A as v,G as c,ab as E,ac as L}from"./index-C8VS4fXx.js";import{S as O}from"./SubjectForm-DAYUhdAu.js";import{N as f}from"./Notification-B1yMlq7q.js";import"./index.esm-BWXX6-1U.js";import"./Input-BklDdty6.js";import"./Card-OmK6nwwd.js";import"./Textarea-BGIjE9FB.js";const A=()=>{const b=N(),{id:t}=y(),[l,S]=r.useState(void 0),[d,o]=r.useState(!0),[p,j]=r.useState(!1),[n,a]=r.useState(null),{user:i}=r.useContext(v);r.useEffect(()=>{t&&typeof t=="string"&&i?.roles.includes(u.SCHOOL_ADMIN)?(async()=>{try{o(!0),a(null);const s=await E(t);S(s)}catch(s){const m=s instanceof Error?s.message:"Failed to fetch subject data.";a(m)}finally{o(!1)}})():(t&&!i?.roles.includes(u.SCHOOL_ADMIN)&&a("You don't have permission to view this subject."),o(!1))},[t,i]);const h=async x=>{if(!(!t||typeof t!="string")){j(!0),a(null);try{await L(t,x),b("/admin/subjects")}catch(s){const m=s instanceof Error?s.message:"Failed to update subject.";a(m),j(!1)}}};return!i?.roles.includes(u.SCHOOL_ADMIN)&&!d?e.jsx(c,{children:e.jsx("div",{className:"container mx-auto p-4",children:e.jsx(f,{message:n||"You do not have permission to edit subjects.",type:"error"})})}):d?e.jsx(c,{children:e.jsx("div",{className:"container mx-auto p-4 text-center",children:"Loading subject data..."})}):!l&&!n?e.jsx(c,{children:e.jsx("div",{className:"container mx-auto p-4 text-center",children:"Subject not found."})}):e.jsx(c,{children:e.jsx("div",{className:"container mx-auto p-4 flex justify-center",children:e.jsxs("div",{className:"w-full max-w-lg",children:[n&&e.jsx(f,{message:n,type:"error",onClose:()=>a(null)}),e.jsx("h1",{className:"text-2xl font-semibold mb-6 text-center",children:"Edit Subject"}),l?e.jsx(O,{initialData:l,onSubmit:h,isSubmitting:p}):!d&&e.jsx("p",{className:"text-center text-red-500",children:"Subject data could not be loaded."})]})})})},R=()=>e.jsx(g,{requiredRoles:[u.SCHOOL_ADMIN],children:e.jsx(A,{})});export{R as default};
