import{j as e,L as u,P as f,U as x,r,A as N,G as h,Q as w,a9 as b}from"./index-C8VS4fXx.js";import{C as S,B as d}from"./Card-OmK6nwwd.js";import{N as j}from"./Notification-B1yMlq7q.js";const v=({subjects:i,onDelete:c})=>e.jsxs(S,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Subject Management"}),e.jsx(d,{component:u,to:"/admin/subjects/create",children:"Create Subject"})]}),i.length===0?e.jsx("p",{children:"No subjects found."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Code"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Classes"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.map(t=>e.jsxs("tr",{children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[t.id.substring(0,8),"..."]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.code||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 truncate max-w-xs",children:t.description||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.classes?.length||0}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-right",children:[e.jsx(d,{component:u,to:`/admin/subjects/${t.id}`,variant:"outline",size:"sm",className:"mr-2",children:"Edit / View Classes"}),e.jsx(d,{variant:"destructive",size:"sm",onClick:()=>c(t.id),children:"Delete"})]})]},t.id))})]})})]}),C=()=>{const[i,c]=r.useState([]),[t,o]=r.useState(!0),[m,a]=r.useState(null),{user:l}=r.useContext(N),p=async()=>{try{o(!0),a(null);const s=await w();c(s)}catch(s){const n=s instanceof Error?s.message:"Failed to fetch subjects.";a(n)}finally{o(!1)}};r.useEffect(()=>{l?.roles.includes(x.SCHOOL_ADMIN)?p():o(!1)},[l]);const g=async s=>{if(window.confirm("Are you sure you want to delete this subject? This action cannot be undone."))try{a(null),await b(s),p()}catch(n){const y=n instanceof Error?n.message:"Failed to delete subject.";a(y)}};return!l?.roles.includes(x.SCHOOL_ADMIN)&&!t?e.jsx(h,{children:e.jsx("div",{className:"container mx-auto p-4",children:e.jsx(j,{message:"You do not have permission to manage subjects.",type:"error"})})}):e.jsx(h,{children:e.jsxs("div",{className:"container mx-auto p-4",children:[m&&e.jsx(j,{message:m,type:"error",onClose:()=>a(null)}),t?e.jsx("p",{className:"text-center",children:"Loading subjects..."}):e.jsx(v,{subjects:i,onDelete:g})]})})},D=()=>e.jsx(f,{requiredRoles:[x.SCHOOL_ADMIN],children:e.jsx(C,{})});export{D as default};
