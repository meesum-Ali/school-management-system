import{u as L,M as R,r as s,j as e,P as c,U as a,G as d,a0 as A,I as P,a1 as H}from"./index-C8VS4fXx.js";import{S as O}from"./StudentForm-B92cLI0L.js";import{N as E}from"./Notification-B1yMlq7q.js";import"./index.esm-BWXX6-1U.js";import"./Input-BklDdty6.js";import"./Card-OmK6nwwd.js";import"./Select-DOi9PUKF.js";const B=()=>{const g=L(),{id:r}=R(),[o,C]=s.useState(void 0),[u,m]=s.useState(!0),[N,x]=s.useState(!1),[i,n]=s.useState(null),[y,b]=s.useState([]),[f,S]=s.useState(!0),[h,j]=s.useState(null);s.useEffect(()=>{(async()=>{if(r)try{m(!0),S(!0),n(null),j(null);const t=A(r),l=P(),[D,I]=await Promise.all([t,l]);C(D),b(I)}catch(t){const l=t instanceof Error?t.message:"Failed to load initial data.";n(l),console.error(t)}finally{m(!1),S(!1)}})()},[r]);const v=async p=>{if(r){x(!0),n(null);try{await H(r,p),g("/admin/students")}catch(t){n(t instanceof Error?t.message:"Failed to update student."),console.error(t),x(!1)}}};return u||f?e.jsx(c,{requiredRoles:[a.SCHOOL_ADMIN,a.TEACHER],children:e.jsx(d,{children:e.jsx("div",{className:"container mx-auto p-4 text-center",children:"Loading data..."})})}):!o&&!i?e.jsx(c,{requiredRoles:[a.SCHOOL_ADMIN,a.TEACHER],children:e.jsx(d,{children:e.jsx("div",{className:"container mx-auto p-4 text-center",children:"Student not found."})})}):e.jsx(c,{requiredRoles:[a.SCHOOL_ADMIN,a.TEACHER],children:e.jsx(d,{children:e.jsx("div",{className:"container mx-auto p-4 flex justify-center",children:e.jsxs("div",{className:"w-full max-w-2xl",children:[i&&e.jsx(E,{message:i,type:"error",onClose:()=>n(null)}),h&&e.jsx(E,{message:h,type:"error",onClose:()=>j(null)}),e.jsx("h1",{className:"text-2xl font-semibold mb-6 text-center",children:"Edit Student"}),o?e.jsx(O,{student:o,onSubmit:v,isSubmitting:N,availableClasses:y}):!u&&!f&&e.jsx("p",{className:"text-center",children:"Student data could not be loaded."})]})})})})};export{B as default};
